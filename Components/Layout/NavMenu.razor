@using CodelineStore.DTOs.CategoryDTOs
@using CodelineStore.Data.Model
@using CodelineStore.Services
@using Microsoft.EntityFrameworkCore
@inject ApplicationDbContext DbContext
@inject ISellerService sellerService
@inject ICategoryService categoryService

<MudPaper Width="250px" Class="d-inline-flex py-3" Elevation="0">
    <MudNavMenu Class="mud-width-full">
        <MudText Typo="Typo.h5" Class="px-4">Main Menu</MudText>
        <MudDivider Class="my-2" />

        <MudNavLink Href="/" Icon="@Icons.Material.Filled.Home">Home</MudNavLink>

        <!-- Brands (Sellers) Navigation Group -->
        <MudNavGroup Title="Brands" Icon="@Icons.Material.Filled.Shop2">
            <MudNavLink Href="/Brands/Apple">
                Apple
            </MudNavLink>
            <MudNavLink Href="/Brands/Samsung">
                Samsung
            </MudNavLink>
            <MudNavLink Href="/Brands/Nike">
                Nike
            </MudNavLink>
            <MudNavLink Href="/Brands/Adidas">
                Adidas
            </MudNavLink>
        </MudNavGroup>

        <MudNavGroup Title="Categories" Icon="@Icons.Material.Filled.Category">
            <MudNavLink Href="/Categories">
                Show All Categories
            </MudNavLink>

            @if (categories != null && categories.Any())
            {
                @foreach (var category in categories)
                {
                    <!-- Use Category ID instead of Name in URL -->
                    <MudNavLink Href="@($"/CategoryProducts/{category.CatId}")">
                        @category.Name
                    </MudNavLink>
                }
            }
            else
            {
                <MudText Typo="Typo.body2">Loading categories...</MudText>
            }
        </MudNavGroup>

        @code {
        private List<CategoryDto> categories = new();

        protected override async Task OnInitializedAsync()
        {
            try
            {
            categories = await DbContext.Categories
            .Select(c => new CategoryDto
                {
                    CatId = c.CatId,  // Fetch correct Category ID
                    Name = c.Name.Trim() // Ensure correct category name
                })
            .ToListAsync();
            }
            catch (Exception ex)
            {
            Console.WriteLine("Error fetching categories: " + ex.Message);
            }
        }

        public class CategoryDto
        {
            public int CatId { get; set; }
            public string Name { get; set; }
        }
        }

       

    </MudNavMenu>
</MudPaper>